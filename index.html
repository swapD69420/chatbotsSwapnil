<html>
<body>

<style type='text/css'>
body .dockableContainer * {
  font-family: open-sans, Arial, sans-serif !important;
  font-size: 14px;
  color: #383838;
  box-sizing: border-box;
  line-height:20px;
}

.dockableContainer .FAQComp,
.dockableContainer .maincardTemp {
  border-radius: 8px;
  background: #F8F2F4;
  text-align: left;
  margin-bottom: -16px;
}

.dockableContainer .FAQComp div,
.dockableContainer .maincardTemp div {
  margin: 0;
  padding: 1em
}



.dockableContainer .maincardTemp .cardHeader {
  margin: 0;
  font-size: 14px
}

.dockableContainer .maincardTemp .cardBody a {
  background: #E90649;
  padding: 10px;
  width: 100%;
  max-width: 100%;
  display: inline-block;
  color: #fff;
  text-decoration: none;
  box-sizing: border-box;
  border-radius: 22px;
  text-align: center;
  font-size: 13px;
  font-weight: bold;
}

.dockableContainer .FAQComp {
  border: 1px solid #740324;
}

.dockableContainer .FAQComp .FAQBody {
  border-top: 1.4px solid #740324;
  font-size: 14px
}

.dockableContainer .FAQComp .FAQHeader {
  background: #fff;
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
  font-size: 14px;
  font-weight: bold;
}

.dockableContainer embeddedservice-chat-header {
  position: relative;
  padding: 0 14px;
  height: 100px;
  max-height: 70px;
  background-color: #E90649
}

.dockableContainer embeddedservice-chat-header header .minimizeButton {
  display: none
}

.dockableContainer embeddedservice-chat-header header .closeButton {
  position: absolute;
  top: 5px;
  right: 0;
  padding: 4px 0 0 0;
  display: flex;
  justify-content: center;
  align-items: center;
  outline: 0;
}

.dockableContainer embeddedservice-chat-header header .closeButton svg {
  width: 14px;
  height: 14px
}

.dockableContainer embeddedservice-chat-header header.sidebarHeader {
  padding: 0
}

.dockableContainer embeddedservice-chat-header header.sidebarHeader img {
  max-width: 67px;
  margin-right: 0;
  max-height: 54px;
  background-image: url(/images/chatbot/icon_circle_xeljanz_update_48x48.svg) !important;
}

.dockableContainer embeddedservice-chat-header header h2 {
  font-weight: 700;
  display: none;
}

.dockableContainer embeddedservice-chat-header div#chatbot-new-header {
  position: absolute;
  top: 11%;
  z-index: 9999;
  text-align: left;
  left: 70px;
  color: #fff;
  line-height: 1;
  font-weight: bold;
  font-size: 18px;

}

.dockableContainer embeddedservice-chat-header div#chatbot-new-header sup{
    color: #fff;
    border: .5px solid !important;
    border-radius: 50%;
    font-size: 3px !important;
    top: -10px !important;
    padding: 0 1px;
    left: .5px !important;
    font-weight: 500!important;
    position: relative;
    }

.dockableContainer embeddedservice-chat-header div#chatbot-new-header span {
  font-size: 12px;
  line-height: 1.3;
  color : #FFFFFF;
}

.dockableContainer embeddedservice-chat-header div:last-child span {
  display: block;
  font-size: 12px;
  font-weight: normal;
}

.dockableContainer embeddedservice-chat-header button.closeButton:hover:before {
  right: 0;
  top: 2px
}

body .dockableContainer a {
  color: #0095ff;
  text-decoration: none;
  cursor:pointer !important;
}

body .dockableContainer a:hover , body .dockableContainer a:focus , body .dockableContainer a:active{
  color: #0095ff;
  text-decoration: none;
  cursor:pointer !important;
}

.chatMessage .chatContent .chat-content.agent,
li.wrapper.chatMessage.agent.withTimestamp.embeddedServiceLiveAgentStateChatItem.embeddedServiceLiveAgentStateChatMessage .chatContent {
  background: #F8F2F4;
  border-radius: 8px;
  max-width: 100%;
  float: none;
  margin-left: 0;
  text-align: left
}

.embeddedServiceHelpButton .helpButton .uiButton {
  background-color: #E90649;
  font-family: Arial, sans-serif
}

.embeddedServiceHelpButton .helpButton .uiButton:focus {
  outline: 1px solid #E90649
}

.chasitorControls .chasitorText {
  display: none
}

.embeddedServiceLiveAgentStateChatInputFooter .chasitorControls {
  margin: 0;
  height: 0;
}

.embeddedServiceLiveAgentStateChatInputFooter.dynamicResizeTextOneRow {
   background:#fff;
   height:0;
   min-height:0;
}

.embeddedServiceSidebarExtendedHeader .content .message {
  display: none
}

.embeddedServiceLiveAgentStateChatItem.agent .agentName {
  display: none
}

.embeddedServiceLiveAgentStateChat .endChatContainer .endChatButton {
  display: none
}

.embeddedServiceLiveAgentStateChatItem .isLightningOutContext .avatar {
  display: none
}

.embeddedServiceLiveAgentStateChatItem.agent .nameAndTimeDotDivider,
.embeddedServiceLiveAgentStateChatItem.agent .timeContent {
  display: none
}

.embeddedServiceLiveAgentStateChatItem.agent .nameAndTimeDotDivider,
.embeddedServiceLiveAgentStateChatItem.agent .timeContent {
  display: none
}

.dockableContainer .chat-content[c-chatMsg_chatMsg] {
  max-width: 100%;
  padding: 10px;
  border-bottom-left-radius: 0;
  float: none;
  margin-left: 0
}

li.wrapper.chatMessage.chasitor.embeddedServiceLiveAgentStateChatItem.embeddedServiceLiveAgentStateChatMessage {
  padding: 0 3px 1px 18px;
  padding-top: 0;
  padding-right: 22px;
  padding-bottom: 0;
  padding-left: 6px;
  display: none
}

.embeddedServiceLiveAgentStateChatItem .nameAndTimeContent {
  display: none
}

.dockableContainer .waitingMessage {
 display:none;	
}

.dockableContainer .waitingGreeting:after {
  color: #383838;
  font-size: 10px;
  content:'Virtual Assistant \a \a XELJANZ is also known as tofacitinib \a and is a prescription medicine \a \a Please see full Prescribing Information \a including BOXED WARNING and \a Medication Guide \a \a This resource is intended for U.S. residents only. \a \a PP-XEL-USA-7183 Â© 2022 Pfizer Inc.\a All rights reserved. February 2022';
  display: block;
  margin-bottom: 1em;
  white-space: pre;
}



.dockableContainer .waitingGreeting {
  font-size: 22px;
  color: #383838;
  font-weight: bold;
}



.dockableContainer .waitingGreeting:before {
  content: 'Welcome to the ';
   color: #383838;
  font-size: 10px;
  display: block;
  white-space: pre;
}



.dockableContainer .callBackText {
  background: #F4F4F4;
  text-align: left;
  font-weight: 550;
  text-transform: uppercase;
  font-size: 12px;
  padding: 1em;
  border-radius: 8px;
  margin-bottom: -18px;
}

.embeddedServiceLiveAgentStateChatItem.chatMessage {
  margin-bottom: 0
}

button.rich-button-item.uiButton--default.uiButton.embeddedServiceLiveAgentStateChatButtonItem {
  box-shadow: 0 0 0px 0 rgb(0 118 222 / 50%);
}

li.wrapper.chatMessage.agent.embeddedServiceLiveAgentStateChatItem.embeddedServiceLiveAgentStateChatButtonMessage {
  border-radius: 0 0 10px 10px;
  margin-top: -10px;
  padding: 0 18px;
}

li.wrapper.chatMessage.agent.embeddedServiceLiveAgentStateChatItem.embeddedServiceLiveAgentStateChatButtonMessage .chatContent {
  background: #F8F2F4;
  display: flex;
  margin-left: 0;
  justify-content: center;
  max-width: 100%;
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
  padding-bottom: 10px
}

li.wrapper.chatMessage.agent.withTimestamp.embeddedServiceLiveAgentStateChatItem.embeddedServiceLiveAgentStateChatMessage {

  border-radius: 10px 10px 0 0;
  padding: 0 18px;
}

embeddedServiceLiveAgentStateChatItem .nameAndTimeContent {
  display: none
}

.embeddedServiceLiveAgentStateChatItem.chatMessage button {
  padding-left: 5%;
  padding-right: 12%;
  margin-right: 8%;
  text-align: left;
  font-size: 14px
}

.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item {
  margin-top: 10px;
  padding: 5px 0;
  min-width: 34%;
  text-align: center;
  border-radius: 21px;
  border: 1.4px solid #740324;
  box-shadow: none;
  opacity: 1;
  background: #F8F2F4;
  font-weight:bold;
}

.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item:focus,
.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item:focus span,
.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item:hover,
.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item:hover span {
  background: #F8F2F4;
  color: #E90649
}

.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item span {
  color: #740324;
  border-radius: 8px
}

.embeddedServiceLiveAgentStateChatItem.chatMessage button.rich-button-item:last-child {
  margin-right: 0
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items {
  border: 1px solid #740324;
  border-radius: 8px;
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items li {
  border: 1px solid #E90649;
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items li:first-of-type {
  border: 0;
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items li {
  border: 0;
}

.embeddedServiceLiveAgentStateChatItem.chatMessage button {
  color: #0095ff;
  text-decoration: none !important
}

.embeddedServiceLiveAgentStateChatMenuMessage .rich-menu {
  width: 100%;
  margin-top: 2%
}

.embeddedServiceLiveAgentStateChatPlaintextMessageDefaultUI.agent.plaintextContent {
  color: var(--lwc-colorTextDefault, #333);
  background: #F8F2F4;
  border-radius: 10px 10px 10px 10px;
  float: left;
  max-width: 100%;
  WIDTH: 94.6%;
  margin-left: 0
}

.dockableContainer ul.main-menu-list>li:first-child {
  display: none
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items.main-menu-list li {
  border-right: none;
  border-left: none;
  border-bottom: 1px solid #000;
  padding: 6px 0;
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items.main-menu-list li:last-of-type {
  border-bottom: 2px solid #9B9B9B;
  border-radius: 0;
}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.main-menu-list li button {
  text-align: left;
  font-weight: bold;
  color: #740324;
  text-transform: uppercase;
  font-size: 12px;
  padding-left: 0;
  padding-right: 0;
  margin-right: 0;

}

.embeddedServiceLiveAgentStateChatItem .chatContent ul.main-menu-list li:nth-child(2) {
  border-right: none;
  border-left: none;
  border-bottom: 1px solid #000
}

.embeddedServiceLiveAgentStateChatMenuMessage ul.rich-menu-items.main-menu-list {
  border: 0;
  border-top: 2px solid #9B9B9B;
  border-radius: 0;
  margin: 20px 0;

}

.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:active,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus:hover,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:hover,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:hover:active {
  color: #E90649
}

.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:active,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus:hover,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:hover:active,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent ul.rich-menu-items .rich-menu-item:hover {
  color: #0095ff
}

.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:active,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus:hover,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:hover:active,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent ul.main-menu-list .rich-menu-item:hover {
  color: #E90649
}

.embeddedServiceLiveAgentStateChat .messageArea:focus {
  border: 0 solid #fff
}

.chatbotStickyIcon {
  position: fixed;
  right: 30%;
  bottom: 15px;
  height: 50px;
  width: 50px;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  background-image: url(/images/chatbot/chatbot_button_active_xeljanz.svg);
  background-position: 1px 1px;
  background-size: 50px;
  background-color: #740324;
  outline: 0 !important;
}

.chatbotStickyIcon.minimized {
  background-image: url(/images/chatbot/chatbot_button_inactive_xeljanz.svg);
  background-position: 1px 0px;
}

.embeddedServiceSidebar.layout-docked .dockableContainer.showDockableContainer,
.embeddedServiceSidebar.layout-float .dockableContainer.showDockableContainer {
  position: fixed;
  border-radius: 0px;
  width: 320px;
  right: 32%;
  left: unset;
}

.embeddedServiceSidebar.layout-docked .dockableContainer.hideDockablecontainer,
.embeddedServiceSidebar.layout-float .dockableContainer.hideDockablecontainer {
  display: none
}

.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:active,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:focus:hover,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:hover,
.embeddedServiceLiveAgentStateChatMenuMessage .chatContent .rich-menu-item:hover:active {
  color: #E90649
}

.dockableContainer .waitingCancelChat {
  display: none;
}

.announcement[embeddedService-chatHeaderAnnouncement_chatHeaderAnnouncement] {
  display: none;
}





.cb-nav-container {
  background-color: #ebebeb;
  display: flex;
  width: 100%;
  max-width: 500px;
  margin: 0 auto;
  height: 40px;
  align-items: center;
  padding: 0;
  border: 1px solid #b6b6b6;
}

.cb-nav-item {
  list-style: none;
  flex: 1;
  font-size: 12px;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  border-right: 1px solid #b6b6b6;
}

.cb-nav-item:last-child {
  border-right: 0px solid black;
}

body .dockableContainer .cb-nav-item a {
  text-decoration: none;
  color: #000;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-weight: bold;
}

#cb-dynamic-nav-list {
  display: none;
  max-width: 100%;
}


.embeddedServiceLiveAgentStateChatItem.chatMessage button:hover,
.embeddedServiceLiveAgentStateChatItem.chatMessage button:hover:focus,
.embeddedServiceLiveAgentStateChatItem.chatMessage button:active,
.embeddedServiceLiveAgentStateChatItem.chatMessage button:active:focus,
.embeddedServiceLiveAgentStateChatItem.chatMessage button:active:hover {
  background: none;
  color: #0095ff;
}

.dockableContainer embeddedservice-chat-header div#chatbot-new-header span:nth-child(1) {
  opacity: 0.7;
  margin-top: -4px;
}

.embeddedServiceSidebar.sidebarMaximized {

  height: 0%;

}

.dockableContainer .uiOutputRichText {
  display: none;
}

.embeddedServiceSidebar.layout-docked .dockableContainer.showDockableContainer,
.embeddedServiceSidebar.layout-float .dockableContainer.showDockableContainer {
    height: calc(80vh - 80px);
    bottom: calc(15vh + 10px);

}
.embeddedServiceLiveAgentStateChatItem .chatContent ul.main-menu-list li button.rich-menu-itemOptionIsClicked, 
.embeddedServiceLiveAgentStateChatItem .chatContent ul.rich-menu-items li button.rich-menu-itemOptionIsClicked {
  color:#BDB8B8;
}

.dockableContainer .endText{
  display:none;
  }

.dockableContainer .subFAQ{
  display:none;
}

.embeddedServiceLiveAgentStateChatAction .embeddedServiceIcon{
  display:none;
}
.dockableContainer .messageArea sup {
  font: inherit;
  font-size: 8px !important;
  position: relative;
  top: -0.2rem !important;
}

@media screen and (max-width: 1279px){
  .chatbotStickyIcon {
    bottom: 30%;
    right: 5%;
    background-position: 1px 1px;
    }

    .embeddedServiceSidebar.layout-docked .dockableContainer.showDockableContainer,
.embeddedServiceSidebar.layout-float .dockableContainer.showDockableContainer {
  height: calc(70% - 55px);
  bottom: calc(30% + 55px);
    right: 7%;
}
}

@media screen and (max-width: 1024px) and (orientation:landscape) {

  .embeddedServiceSidebar.layout-docked .dockableContainer.showDockableContainer,
  .embeddedServiceSidebar.layout-float .dockableContainer.showDockableContainer {
    width: 100%;
    height: 70%;
    left: unset;
    right: 0;
    max-width: 100%;
    top: 0;
  }

  #cb-dynamic-nav-list {
    display: flex;
    min-width: 100%;
  }

}

@media all and (max-width: 768px) {
  @supports not (-webkit-touch-callout: none) {
    /* CSS for other than iOS devices */
	@-moz-document url-prefix() {
      .announcement[embeddedService-chatHeaderAnnouncement_chatHeaderAnnouncement]{
		display:block;
		color:#fff;
	  }
	}
  }
  #cb-dynamic-nav-list {
    display: flex;
    min-width: 100%;
    
  }


  .embeddedServiceSidebar.layout-docked .dockableContainer.showDockableContainer,
  .embeddedServiceSidebar.layout-float .dockableContainer.showDockableContainer {
    margin: 0;
    min-width: 100%;
    max-width: 100%;
    max-height: 90%;
    top: 0;
    right: 0;
    width: 100%;
    height : calc(80% - 67px); 

   
  }
  
  .chatbotStickyIcon {
  right: 5%;
   background-position: 1px 1px;
   /*bottom: calc(20% + 92px);*/
	
  }

  .dockableContainer .waitingMessage,
  .dockableContainer .waitingMessage:before,
  .dockableContainer .waitingMessage:after {
    font-size: 12px;
  }

  .dockableContainer .waitingGreeting {
    font-size: 26px;
  }

  .dockableContainer .waitingGreeting:before,
  .dockableContainer .waitingGreeting:after {
    font-size: 16px;
  }
.dockableContainer .waitingStateContent {
    display:block;
    overflow:scroll;

    scrollbar-width:none;
    -ms-overflow-style:none;
}

.dockableContainer .waitingStateContent::-webkit-scrollbar {
    display: none;
}

}

@media screen and (max-width: 768px) and (orientation:landscape) {

  .embeddedServiceSidebar.layout-docked .dockableContainer.showDockableContainer,
  .embeddedServiceSidebar.layout-float .dockableContainer.showDockableContainer {
    width: 100%;
  }


}

@media all and (min-width: 768px) {
  .dockableContainer .waitingGreetingContent {
    margin-bottom: 0px;
  }
}


</style>
<button class="chatbotStickyIcon" onclick = "showEmbeddedDiv(this)"><img class="stickyImage" src="https://pfizerpatientservices--helpdesk--c.visualforce.com/resource/1635411532000/Gen_Image"></img></button> 

<script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>

<script type='text/javascript'>
  (function(l){function d(){var a=!1,b;this.settings={appendHelpButton:!0,displayHelpButton:!0,isExternalPage:!0,devMode:!1,targetElement:document.body,elementForOnlineDisplay:void 0,elementForOfflineDisplay:void 0,defaultMinimizedText:"",disabledMinimizedText:"",defaultAssistiveText:"",loadingText:"Loading",showIcon:void 0,enabledFeatures:[],entryFeature:"FieldService",storageDomain:document.domain,language:void 0,linkAction:{feature:void 0,name:void 0,valid:!1},linkActionParameters:{},useCustomAuthentication:!1,
allowGuestUsers:!1,requireSLDS:!1,hasBottomTabBar:!1};this.auth={};this.validLinkActions={};this.alwaysWarnOnBeforeUnload=!1;Object.defineProperty(this.auth,"oauthToken",{get:function(){return b},set:function(c){this.validateHeaderValue(c)?(b=c)?(this.setSessionData("ESW_OAUTH_TOKEN",c),this.checkAuthentication()):this.deleteSessionData("ESW_OAUTH_TOKEN"):this.error('"'+c+'" is not a valid OAuth token.')}.bind(this)});this.featureScripts={};this.storedEventHandlers={};this.messageHandlers={};this.storageKeys=
["ESW_BODY_SCROLL_POSITION","ESW_IS_MINIMIZED","ESW_MINIMIZED_TEXT","ESW_OAUTH_TOKEN"];this.defaultSettings={};this.snippetSettingsFile={};this.eswFrame=void 0;this.availableFeatures=["script","session"];this.outboundMessagesAwaitingIframeLoad=[];this.pendingMessages={};this.iframeScriptsToLoad=[];this.isAuthenticationRequired=this.isIframeReady=this.hasSessionDataLoaded=this.componentInitInProgress=this.domInitInProgress=!1;this.loginPendingSerializedData=void 0;this.componentLoaded=!1;Object.defineProperty(this,
"isButtonDisabled",{get:function(){return a},set:function(c){a=c;this.onButtonStatusChange()}.bind(this),configurable:!0});this.setupMessageListener();this.getLinkActionData()}var m=[".salesforce.com",".force.com",".sfdc.net"];d.prototype.getLightningOutParamsObj=function(){var a={};embedded_svc.config&&embedded_svc.config.additionalSettings&&embedded_svc.config.additionalSettings.labelsLanguage?a={guestUserLang:embedded_svc.config.additionalSettings.labelsLanguage}:embedded_svc.settings.language&&
""!==embedded_svc.settings.language.trim()&&(a={guestUserLang:embedded_svc.settings.language});a.eswConfigDeveloperName=embedded_svc.settings.eswConfigDevName;return a};d.prototype.adjustCommunityStorageDomain=function(){this.isCommunityDomain(this.settings.storageDomain)&&this.settings.storageDomain===document.domain&&(this.settings.storageDomain=this.settings.storageDomain+"/"+window.location.pathname.split("/")[1])};d.prototype.loadLightningOutScripts=function(a){if("function"!==typeof Promise)this.loadScriptFromDirectory("common",
"promisepolyfill",function(){return this.loadLightningOutScripts(a)}.bind(this),!0);else return new Promise(function(b,c){try{var e=a&&a.baseCoreURL?a.baseCoreURL:embedded_svc.settings.baseCoreURL;if(window.$Lightning)b("Lightning Out is already loaded on this page.");else if(embedded_svc.utils.isCommunityOrSite())b("Communities context does not require Lightning Out to use Embedded Service.");else if(e){var f=document.createElement("script");f.type="text/javascript";f.src=e+"/lightning/lightning.out.js";
f.onload=function(){b("Lightning Out scripts loaded.")};document.getElementsByTagName("head")[0].appendChild(f)}}catch(h){c(h)}})};d.prototype.instantiateLightningOutApplication=function(a){if("function"!==typeof Promise)this.loadScriptFromDirectory("common","promisepolyfill",function(){return this.instantiateLightningOutApplication(a)}.bind(this),!0);else return new Promise(function(b,c){try{var e=a&&a.communityEndpointURL?a.communityEndpointURL:embedded_svc.settings.communityEndpointURL;var f=a&&
a.oauthToken?a.oauthToken:embedded_svc.settings.oauthToken;var h=a&&a.paramsObj?a.paramsObj:embedded_svc.getLightningOutParamsObj()||void 0;embedded_svc.utils.isCommunityOrSite()?b("Communities context already has an Aura context."):window.$Lightning&&$Lightning.use("embeddedService:sidebarApp",function(){b("Lightning Out application request complete.")},e,f,h)}catch(g){c(g)}})};d.prototype.createEmbeddedServiceComponent=function(a){if("function"!==typeof Promise)this.loadScriptFromDirectory("common",
"promisepolyfill",function(){return this.createEmbeddedServiceComponent(a)}.bind(this),!0);else return new Promise(function(b,c){var e=a&&a.chatAPISettings?embedded_svc.validateStartChatAttributes(a.chatAPISettings):{};try{var f=a&&a.attributes?a.attributes:{configurationData:embedded_svc.settings,chatAPISettings:e};var h=a&&a.locator?a.locator:embedded_svc.settings.targetElement;embedded_svc.preparePageForSidebar();window.$Lightning&&!document.querySelector(".embeddedServiceSidebar")?$Lightning.ready($Lightning.createComponent.bind(this,
"embeddedService:sidebar",f,h,function(g,k,n){"SUCCESS"===k?embedded_svc.utils.addEventHandler("afterInitialization",function(){b("Embedded Service component created.")}):c(n)})):embedded_svc.utils.isCommunityOrSite()?window.dispatchEvent(new CustomEvent("embeddedServiceCreateSidebar",{detail:{componentAttributes:f,resolve:b,reject:c}})):"undefined"===typeof window.$Lightning?b("Lightning Out should be loaded on this page before creating the Embedded Service component."):b("Embedded Service component already exists.")}catch(g){c(g)}})};
d.prototype.bootstrapEmbeddedService=function(a){if("function"!==typeof Promise)this.loadScriptFromDirectory("common","promisepolyfill",function(){return embedded_svc.bootstrapEmbeddedService(a)},!0);else return new Promise(function(b,c){try{embedded_svc.loadLightningOutScripts(a).then(function(){embedded_svc.instantiateLightningOutApplication(a).then(function(){embedded_svc.createEmbeddedServiceComponent(a).then(function(){window.requestAnimationFrame(function(){embedded_svc.hideHelpButton();b("Embedded Service application and component bootstrapped.")})})})})}catch(e){c(e)}})};
d.prototype.validateStartChatAttributes=function(a){var b=(a=a?a:{})&&a.prepopulatedPrechatFields?a.prepopulatedPrechatFields:{},c=a&&a.extraPrechatInfo?a.extraPrechatInfo:[],e=a&&a.extraPrechatFormDetails?a.extraPrechatFormDetails:[],f=a&&a.fallbackRouting?a.fallbackRouting:[],h=a&&a.directToButtonRouting?a.directToButtonRouting:void 0,g={buttonId:a&&a.buttonId?a.buttonId:void 0,userId:a&&a.userId?a.userId:void 0,fallback:a&&"boolean"===typeof a.fallback?a.fallback:void 0};if("object"===typeof b)a.prepopulatedPrechatFields=
b;else throw Error("Validation failed for prepopulatedPrechatFields, received: "+b);if(Array.isArray(e))a.extraPrechatFormDetails=e;else throw Error("Validation failed for extraPrechatFormDetails, received: "+e);if(Array.isArray(c))a.extraPrechatInfo=c;else throw Error("Validation failed for extraPrechatInfo, received: "+c);if(Array.isArray(f))a.fallbackRouting=f;else throw Error("Validation failed for fallbackRouting, received: "+f);"function"===typeof h?a.directToButtonRouting=h:embedded_svc.log("Did not receive an actionable parameter for directToButtonRouting, received: "+
h);if("object"===typeof g)if(a.directToAgentRouting=g,g.buttonId)if("string"===typeof g.buttonId&&g.buttonId.trim().length)a.directToAgentRouting.buttonId=g.buttonId.trim(),a.directToAgentRouting.fallback=g.fallback,g.userId&&("string"===typeof g.userId&&g.userId.trim().length?a.directToAgentRouting.userId=g.userId.trim():embedded_svc.log("Did not receive an actionable parameter for directToAgentRouting's userId, received: "+g.userId));else throw Error("Validation failed for directToAgentRouting's buttonId, received: "+
g.buttonId);else embedded_svc.log("Did not receive an actionable parameter for directToAgentRouting's buttonId, received: "+g.buttonId);else throw Error("Validation failed for directToAgentRouting, received: "+g);return a};d.prototype.isInternetExplorer=function(){return"ActiveXObject"in window};d.prototype.outputToConsole=function(a,b,c){if((c||this.settings.devMode)&&console&&console[a])console[a]("[Snap-ins] "+(Array.isArray(b)?b.join(", "):b))};d.prototype.log=function(){this.outputToConsole("log",
[].slice.apply(arguments))};d.prototype.error=function(a,b){a?this.outputToConsole("error",a,b):this.outputToConsole("error","esw responed with an unspecified error.",b);embedded_svc.utils.fireEvent("error")};d.prototype.warning=function(a,b){a?this.outputToConsole("warn","Warning: "+a,b):this.outputToConsole("warn","esw sent an anonymous warning.",b)};d.prototype.deprecated=function(a){this.warning(a+" is deprecated in version "+Number("5.0").toFixed(1)+" and will be removed in version "+(Number("5.0")+
1).toFixed(1))};d.prototype.getCookie=function(a){var b=document.cookie;if(b){var c=b.indexOf(a+"=");if(-1!==c)return c+=(a+"=").length,a=b.indexOf(";",c),-1===a&&(a=b.length),b.substring(c,a)}};d.prototype.setCookie=function(a,b,c){a=a+"="+b+";";c&&(c=new Date,c.setFullYear(c.getFullYear()+10),a+="expires="+c.toUTCString()+";");document.cookie=a+"path=/;"};d.prototype.mergeSettings=function(a){Object.keys(a).forEach(function(b){void 0===this.settings[b]&&(this.settings[b]=a[b])}.bind(this))};d.prototype.loadFeatureScript=
function(a,b){var c=decodeURI(a).toLowerCase();-1===a.indexOf("..")?this.loadScriptFromDirectory("client",c+".esw",function(){this.featureScripts[a](this);this.availableFeatures.push(c);embedded_svc.utils.fireEvent("featureLoaded",void 0,a);b&&b();this.processPendingMessages(c)}.bind(this)):this.error('"'+a+'" is not a valid feature name.')};d.prototype.fireEvent=function(a,b){var c=[].slice.apply(arguments).slice(2);if(window.embedded_svc&&embedded_svc.utils)return embedded_svc.utils.fireEvent(a,
b,c);this.error("fireEvent should not be called before calling init!");return!0};d.prototype.isValidEntityId=function(a){return"string"===typeof a&&(18===a.length||15===a.length)};d.prototype.getKeyPrefix=function(a){if(this.isValidEntityId(a))return a.substr(0,3)};d.prototype.isOrganizationId=function(a){return"00D"===this.getKeyPrefix(a)};d.prototype.getESWFrame=function(){var a=document.getElementById("esw_storage_iframe");!this.eswFrame&&a&&(this.eswFrame=a.contentWindow);return this.eswFrame};
d.prototype.isFrameStorageEnabled=function(){this.deprecated("isFrameStorageEnabled");return!0};d.prototype.processPendingMessages=function(a){this.pendingMessages[a]&&(this.pendingMessages[a].forEach(function(b){this.handleMessage(b.payload)}.bind(this)),this.pendingMessages[a]=void 0)};d.prototype.loadCSS=function(){var a=document.createElement("link");a.href=(this.settings.gslbBaseURL?this.settings.gslbBaseURL:this.settings.baseCoreURL)+"/embeddedservice/"+this.settings.releaseVersion+"/esw"+(this.settings.devMode?
"":".min")+".css";a.type="text/css";a.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(a)};d.prototype.appendHelpButton=function(a){var b=document.createElement("div"),c="";b.className="embeddedServiceHelpButton";this.isLanguageRtl(this.settings.language)&&this.isDesktop()&&(c='dir="rtl"');b.innerHTML='<div class="helpButton"'+c+'><button class="helpButtonEnabled uiButton" href="javascript:void(0)"><span class="embeddedServiceIcon" aria-hidden="true" data-icon="&#59648;"></span><span class="helpButtonLabel" id="helpButtonSpan" aria-live="polite" aria-atomic="true"><span class="assistiveText">'+
(this.settings.defaultAssistiveText||"")+'</span><span class="message"></span></span></button></div>';a||(b.style.display="none");this.settings.hasBottomTabBar&&b.classList.add("embeddedServiceBottomTabBar");this.settings.targetElement.appendChild(b);this.setHelpButtonText(this.settings.defaultMinimizedText);"ontouchstart"in document.documentElement&&[].slice.apply(document.querySelectorAll(".embeddedServiceHelpButton .uiButton")).forEach(function(e){e.classList.add("no-hover")});this.onButtonStatusChange()};
d.prototype.appendIFrame=function(){var a=document.createElement("iframe"),b={};a.id="esw_storage_iframe";a.src=this.settings.iframeURL;a.style.display="none";a.title="Live Chat Metadata";a.onload=function(){var c=this.getESWFrame();this.isIframeReady=!0;this.outboundMessagesAwaitingIframeLoad.forEach(function(e){c.postMessage(e,this.settings.iframeURL)}.bind(this));this.outboundMessagesAwaitingIframeLoad=[];this.iframeScriptsToLoad.forEach(function(e){this.loadStorageScript(e)}.bind(this));b.deploymentId=
this.settings.deploymentId;b.isSamePageNavigation=this.isSamePageNavigation();b.isRefresh=1===window.performance.navigation.type;this.postMessage("session.updateStorage",b);this.iframeScriptsToLoad=[]}.bind(this);this.settings.targetElement.appendChild(a);window.addEventListener("beforeunload",function(c){this.isInternetExplorer()&&(a.src="about:blank");if(this.warnOnBeforeUnload&&this.componentLoaded)if(embedded_svc.utils.fireEvent("snapinsCloseSessionWarning"),this.settings.closeSessionWarning&&
"function"===typeof this.settings.closeSessionWarning)this.settings.closeSessionWarning();else return(c||window.event).returnValue="You might lose the active chat session if you close this tab. Are you sure?"}.bind(this),!1)};d.prototype.preparePageForSidebar=function(){document.getElementById("snapins_invite")&&embedded_svc.inviteAPI&&embedded_svc.inviteAPI.inviteButton.setOnlineState(!1);embedded_svc.utils.fireEvent("beforeCreate");Object.keys(this.settings).forEach(function(a){}.bind(this));this.mergeSettings(this.defaultSettings)};
d.prototype.createLightningComponent=function(a){this.preparePageForSidebar();this.createEmbeddedServiceComponent({attributes:{configurationData:this.settings,serializedSessionData:a},locator:this.settings.targetElement}).then(function(){this.hideHelpButton();this.componentInitInProgress=!1;this.componentLoaded=!0;embedded_svc&&embedded_svc.liveAgentAPI&&embedded_svc.liveAgentAPI.ping();embedded_svc.utils.fireEvent("ready")}.bind(this))};d.prototype.loadLightningApp=function(a){var b;if(this.settings.isExternalPage&&
"string"!==typeof this.settings.communityEndpointURL)throw Error("communityEndpointURL String property not set");if(b=document.getElementsByClassName("helpButton")[0]){var c=b.getBoundingClientRect().width;0<c&&(b.style.width=c+"px")}this.setHelpButtonText(this.settings.loadingText,!1);this.instantiateLightningOutApplication({communityEndpointURL:this.settings.communityEndpointURL,oauthToken:this.auth.oauthToken}).then(this.createLightningComponent.bind(this,a))};d.prototype.initLightningOut=function(a){this.hasSessionDataLoaded&&
("function"!==typeof Promise?this.loadScriptFromDirectory("common","promisepolyfill",function(){this.initLightningOut(a)}.bind(this),!0):this.loadLightningOutScripts().then(this.loadLightningApp.bind(this,a)))};d.prototype.setHelpButtonText=function(a,b){var c=void 0===this.settings.showIcon?!0:this.settings.showIcon;b=void 0===b?c:b;c=document.getElementById("helpButtonSpan");if(c){var e=c.querySelector(".message");e.innerHTML=a;if(a=c.parentElement.querySelector(".embeddedServiceIcon"))a.style.display=
b?"inline-block":"none"}};d.prototype.prepareDOM=function(){this.domInitInProgress||(this.domInitInProgress=!0,this.appendIFrame())};d.prototype.addSessionHandlers=function(){this.addMessageHandler("session.onLoad",function(){this.postMessage("session.get",this.storageKeys)}.bind(this));this.addMessageHandler("session.sessionData",function(a){this.alwaysWarnOnBeforeUnload=!a;this.resumeInitWithSessionData(a||{})}.bind(this));this.addMessageHandler("session.deletedSessionData",function(a){-1<a.indexOf("CHASITOR_SERIALIZED_KEY")&&
(this.loginPendingSerializedData=void 0)}.bind(this));this.addMessageHandler("session.updatePrimary",function(a){a&&(a.isPrimary?sessionStorage.setItem(this.settings.storageDomain+"MASTER_DEPLOYMENT_ID",this.settings.deploymentId):sessionStorage.removeItem(this.settings.storageDomain+"MASTER_DEPLOYMENT_ID"),this.warnOnBeforeUnload=this.alwaysWarnOnBeforeUnload||1<a.activeChatSessions&&a.isPrimary,embedded_svc&&embedded_svc.liveAgentAPI&&(embedded_svc.liveAgentAPI.browserSessionInfo=a))}.bind(this))};
d.prototype.addMetaTag=function(a,b){var c=document.createElement("meta");c.name=a;c.content=b;document.head.appendChild(c)};d.prototype.init=function(a,b,c,e,f,h){this.settings.baseCoreURL=a;this.settings.communityEndpointURL=b;this.settings.gslbBaseURL=c?c:a;this.settings.orgId=e;this.settings.releaseVersion="5.0";this.settings.eswConfigDevName=f;this.mergeSettings(h||{});this.adjustCommunityStorageDomain();if("string"!==typeof this.settings.baseCoreURL)throw Error("Base core URL value must be a string.");
if(!this.isOrganizationId(this.settings.orgId))throw Error("Invalid OrganizationId Parameter Value: "+this.settings.orgId);embedded_svc.utils?this.finishInit():this.loadScriptFromDirectory("utils","common",this.finishInit.bind(this))};d.prototype.finishInit=function(){this.storedEventHandlers&&(Object.getOwnPropertyNames(this.storedEventHandlers).forEach(function(a){this.storedEventHandlers[a].forEach(function(b){embedded_svc.utils.addEventHandler(a,b)})}.bind(this)),this.storedEventHandlers={});
if(!embedded_svc.utils.fireEvent("validateInit",function(a){return-1!==a.indexOf(!1)},this.settings)){this.checkForNativeFunctionOverrides();this.settings.appendHelpButton&&this.loadCSS();if(!this.settings.targetElement)throw Error("No targetElement specified");this.settings.iframeURL=this.settings.gslbBaseURL+"/embeddedservice/"+this.settings.releaseVersion+(this.settings.devMode?"/eswDev.html":"/esw.html")+"?parent="+document.location.href;this.addSessionHandlers();this.loadFeatures(this.onFeatureScriptsLoaded.bind(this));
this.settings.hasBottomTabBar=this.isUseriOS15plusSafari?this.isUseriOS15plusSafari():!1;embedded_svc.utils.fireEvent("afterInit",void 0,this.settings)}};d.prototype.onFeatureScriptsLoaded=function(){"complete"===document.readyState?setTimeout(this.prepareDOM.bind(this),1):document.addEventListener?(document.addEventListener("DOMContentLoaded",this.prepareDOM.bind(this),!1),window.addEventListener("load",this.prepareDOM.bind(this),!1)):window.attachEvent?window.attachEvent("onload",this.prepareDOM.bind(this)):
this.log("No available event model. Exiting.")};d.prototype.checkForNativeFunctionOverrides=function(){[{name:"document",object:document,functions:"addEventListener createAttribute createComment createDocumentFragment createElementNS createTextNode createRange getElementById getElementsByTagName getElementsByClassName querySelector querySelectorAll removeEventListener".split(" ")},{name:"window",object:window,functions:"addEventListener clearTimeout dispatchEvent open removeEventListener requestAnimationFrame setInterval setTimeout".split(" ")}].forEach(function(a){a.functions.forEach(function(b){b in
a.object&&!this.isNativeFunction(a.object,b)&&this.warning("Embedded Service Chat may not function correctly with this native JS function modified: "+a.name+"."+b,!0)}.bind(this))}.bind(this))};d.prototype.isNativeFunction=function(a,b){return Function.prototype.toString.call(a[b]).match(/\[native code\]/)};d.prototype.isUseriOS15plusSafari=function(){var a=!!navigator.userAgent.match(/iP(hone|ad|od)/i),b=navigator.userAgent.match(/(?!=OS)(([0-9]){2})/i);b=b&&0<b.length?Number(b[0]):-1;var c=!!navigator.userAgent.match(/WebKit/i)&&
!navigator.userAgent.match(/CriOS/i);return a&&c&&15<=b};d.prototype.onHelpButtonClick=function(){if(!this.componentInitInProgress&&!document.getElementsByClassName("embeddedServiceSidebar").length){this.componentInitInProgress=!0;try{embedded_svc.utils.isCommunityOrSite()&&0<Object.keys(embedded_svc.liveAgentAPI.inviteButton).length?window.dispatchEvent(new CustomEvent("onStartChatFromInvitation"),{detail:{bubbles:!0,composed:!1}}):(this.checkAuthentication(),embedded_svc.utils.fireEvent("onHelpButtonClick"))}catch(a){throw this.componentInitInProgress=
!1,a;}}};d.prototype.resumeInitWithSessionData=function(a){var b=embedded_svc.utils.fireEvent("sessionDataRetrieved",function(f){return-1!==f.indexOf(!0)},a),c=!1,e=!1;this.settings.linkAction.valid?c=!0:b?(this.log("Existing session found. Continuing with data: "+a),e=c=!0,embedded_svc.menu&&embedded_svc.menu.hideTopContainer()):this.componentInitInProgress&&(c=!0);this.hasSessionDataLoaded=!0;a.ESW_OAUTH_TOKEN&&(this.auth.oauthToken=a.ESW_OAUTH_TOKEN);this.loginPendingSerializedData=e?a:void 0;
c&&(this.componentInitInProgress=!0,this.checkAuthentication());this.settings.appendHelpButton&&this.appendHelpButton(this.settings.displayHelpButton&&!b)};d.prototype.checkAuthentication=function(){this.isAuthenticationRequired&&!this.settings.allowGuestUsers?this.auth.oauthToken?(this.loginButtonPressed||this.componentInitInProgress)&&this.initLightningOut(this.loginPendingSerializedData):embedded_svc.utils.fireEvent("requireauth"):(this.loginButtonPressed||this.componentInitInProgress)&&this.initLightningOut(this.loginPendingSerializedData)};
d.prototype.postMessage=function(a,b){a={domain:this.settings.storageDomain,data:b,method:a};(b=this.getESWFrame())?b.postMessage(a,this.settings.iframeURL):this.outboundMessagesAwaitingIframeLoad.push(a)};d.prototype.setSessionData=function(a,b){if("object"===typeof a)var c=a;else c={},c[a]=b;this.postMessage("session.set",c)};d.prototype.deleteSessionData=function(a){a=Array.isArray(a)?a:[a];this.postMessage("session.delete",a)};d.prototype.defineFeature=function(a,b){this.featureScripts[a]=b};
d.prototype.registerStorageKeys=function(a){"string"===typeof a?this.storageKeys.push(a):a.forEach(function(b){this.storageKeys.push(b)}.bind(this))};d.prototype.addMessageHandler=function(a,b){this.messageHandlers[a]||(this.messageHandlers[a]=[]);this.messageHandlers[a].push(b)};var p="liveagent.chatCanceledOnDifferentTab liveagent.fileTransfer.resetFileSelector liveagent.fileTransfer.uploadFile session.deletedSessionData session.onLoad session.sessionData session.updateMaster".split(" ");d.prototype.clearMessageHandlers=
function(){Object.keys(this.messageHandlers).filter(function(a){return-1===p.indexOf(a)}).forEach(function(a){this.messageHandlers[a]=[]}.bind(this))};d.prototype.loadStorageScript=function(a){this.isIframeReady?this.postMessage("script.load",a):this.iframeScriptsToLoad.push(a)};d.prototype.loadScriptFromDirectory=function(a,b,c,e){b=b.toLowerCase();var f=document.createElement("script"),h=this.settings.gslbBaseURL,g=b.replace(".","-")+"-script";f.id=g;f.type="text/javascript";f.src=[h,"embeddedservice",
e?void 0:this.settings.releaseVersion,a,b+(this.settings.devMode?"":".min")+".js"].filter(function(k){return!!k}).join("/");c&&(f.onload=c);document.body.appendChild(f)};d.prototype.loadFeatures=function(a){this.settings.enabledFeatures.forEach(function(b){"base"!==b&&-1===this.availableFeatures.indexOf(b.toLowerCase())&&this.loadFeatureScript(b,a)}.bind(this))};d.prototype.addEventHandler=function(a,b){window.embedded_svc&&embedded_svc.utils?embedded_svc.utils.addEventHandler(a,b):(this.storedEventHandlers[a]||
(this.storedEventHandlers[a]=[]),this.storedEventHandlers[a].push(b))};d.prototype.setupMessageListener=function(){window.addEventListener("message",function(a){var b=a.data,c=a.origin.split(":")[1].replace("//","");b&&b.method&&embedded_svc.isMessageFromSalesforceDomain(c)&&("session.onLoad"===b.method&&-1===this.settings.iframeURL.indexOf(c)&&(c=this.settings.iframeURL.split("/")[2],a=a.origin.split("/")[2],this.settings.iframeURL=this.settings.iframeURL.replace(c,a)),a=b.method.split(".")[0].toLowerCase(),
-1===this.availableFeatures.indexOf(a)?(this.pendingMessages[a]||(this.pendingMessages[a]=[]),this.pendingMessages[a].push({direction:"incoming",payload:b})):this.handleMessage(b))}.bind(this),!1)};d.prototype.handleMessage=function(a){var b=this.messageHandlers[a.method];b?b.forEach(function(c){c(a.data)}):this.log("Unregistered method "+a.method+" received.")};d.prototype.isMessageFromSalesforceDomain=function(a){if(embedded_svc.utils.isCommunityOrSite()&&a===document.domain)return!0;var b=function(c,
e){return-1!==c.indexOf(e,c.length-e.length)};return m.some(function(c){return b(a,c)})};d.prototype.isCommunityDomain=function(a){return".force.com"===a.substr(-10)};d.prototype.isSamePageNavigation=function(){var a=document.domain;if(this.isCommunityDomain(document.domain)){var b=a+"/"+window.location.pathname.split("/")[1];b===this.settings.storageDomain&&(a=b)}return a.substr(-this.settings.storageDomain.length)===this.settings.storageDomain};d.prototype.addDefaultSetting=function(a,b){this.defaultSettings[a]=
b};d.prototype.onButtonStatusChange=function(){var a=document.querySelector(".embeddedServiceHelpButton button"),b;if(embedded_svc.menu)embedded_svc.menu.onAgentAvailabilityChange();a&&(b=a.querySelector(".message"))&&(this.isButtonDisabled?(a.onclick=function(){},a.classList.remove("helpButtonEnabled"),a.classList.add("helpButtonDisabled"),b.innerHTML=this.settings.disabledMinimizedText):(a.onclick=this.onHelpButtonClick.bind(this),a.classList.remove("helpButtonDisabled"),a.classList.add("helpButtonEnabled"),
b.innerHTML=this.settings.defaultMinimizedText))};d.prototype.hideHelpButton=function(){var a=document.querySelector(".embeddedServiceHelpButton");a&&(a.style.display="none")};d.prototype.showHelpButton=function(){var a=document.querySelector(".embeddedServiceHelpButton");a&&(a.style.display="")};d.prototype.setDefaultButtonText=function(a,b,c,e){this.settings.entryFeature===a&&(this.settings.defaultMinimizedText=this.settings.defaultMinimizedText||b,this.settings.disabledMinimizedText=this.settings.disabledMinimizedText||
c,this.settings.defaultAssistiveText=this.settings.defaultAssistiveText||e||"")};d.prototype.setDefaultShowIcon=function(a,b){this.settings.entryFeature===a&&void 0===this.settings.showIcon&&(this.settings.showIcon=b)};d.prototype.registerLinkAction=function(a,b){var c=this.settings.linkAction;this.validLinkActions[a]||(this.validLinkActions[a]=[]);-1===this.validLinkActions[a].indexOf(b)&&this.validLinkActions[a].push(b);c.feature&&c.name&&c.feature.toLowerCase()===a.toLowerCase()&&c.name.toLowerCase()===
b.toLowerCase()&&(c.valid=!0,c.feature=a,this.settings.entryFeature=a)};d.prototype.setLinkAction=function(a,b,c){var e=Object.keys(this.validLinkActions).filter(function(f){return f.toLowerCase()===a.toLowerCase()})[0];e?(this.settings.linkAction.feature=e,this.settings.linkAction.name=this.validLinkActions[e].filter(function(f){return f.toLowerCase()===b.toLowerCase()})[0],this.settings.linkAction.valid=void 0!==this.settings.linkAction.name,this.settings.linkActionParameters=c):this.settings.linkAction.valid=
!1};d.prototype.getLinkActionData=function(){window.location.search.replace(/([a-zA-Z0-9._]+)=([^&\s]+)/g,function(a,b,c){a=b.toLowerCase();0===a.indexOf("snapins.")&&(a=a.replace("snapins.",""),"action"===a?(c=c.split("."),2===c.length&&(this.settings.linkAction.feature=c[0],this.settings.linkAction.name=c[1])):this.settings.linkActionParameters[a.toLowerCase()]=c)}.bind(this))};d.prototype.requireAuthentication=function(){var a=document.createElement("script"),b=document.createElement("style"),
c=document.querySelector(this.settings.loginTargetQuerySelector);this.isAuthenticationRequired=!0;if("https:"!==window.location.protocol&&!this.settings.devMode)throw this.settings.displayHelpButton=!1,Error("Snap-in authentication requires HTTPS.");if(!this.settings.useCustomAuthentication){if(!this.settings.loginClientId||!this.settings.loginRedirectURL||!this.settings.loginTargetQuerySelector)throw Error("Authentication in Snap-ins requires these valid settings params: loginClientId, loginRedirectURL, loginTargetQuerySelector.");
if(c)this.loginButtonPressed=!1,c.addEventListener("click",function(){this.loginButtonPressed=!0}.bind(this));else throw Error("loginTargetQuerySelector is not a valid DOM element.");this.addMetaTag("salesforce-community",this.settings.communityEndpointURL);this.addMetaTag("salesforce-client-id",this.settings.loginClientId);this.addMetaTag("salesforce-redirect-uri",this.settings.loginRedirectURL);this.addMetaTag("salesforce-mode","popup");this.addMetaTag("salesforce-target",this.settings.loginTargetQuerySelector);
this.addMetaTag("salesforce-login-handler","__snapinsLoginCallback");this.addMetaTag("salesforce-logout-handler","__snapinsLogoutCallback");embedded_svc.utils.addEventHandler("requireauth",function(){var e=setInterval(function(){window.SFIDWidget&&(clearInterval(e),window.SFIDWidget.openid_response?window.__snapinsLoginCallback():window.SFIDWidget.login())},100)});embedded_svc.utils.addEventHandler("autherror",function(e){if(window.SFIDWidget){this.loginButtonPressed=!0;window.SFIDWidget.logout();
var f=setInterval(function(){window.SFIDWidget.config&&(clearInterval(f),embedded_svc.utils.fireEvent("requireauth"))}.bind(this,f),100)}}.bind(this));window.__snapinsLoginCallback=function(){var e=document.querySelector(this.settings.loginTargetQuerySelector),f=document.createElement("button");if(this.loginButtonPressed||this.componentInitInProgress)e.innerHTML="";f.className="authenticationStart";f.innerHTML=this.settings.authenticationStartLabel;f.addEventListener("click",this.onHelpButtonClick.bind(this));
e.appendChild(f);this.auth.oauthToken=window.SFIDWidget.openid_response.access_token}.bind(this);window.__snapinsLogoutCallback=function(){this.auth.oauthToken=void 0;window.SFIDWidget.init()}.bind(this);document.head.appendChild(b);b.sheet.insertRule(".sfid-logout { display: none; }",0);a.type="text/javascript";a.src=this.settings.communityEndpointURL+"/servlet/servlet.loginwidgetcontroller?type=javascript_widget"+(embedded_svc.settings.devMode?"&min=false":"");document.head.appendChild(a)}};d.prototype.requireSLDS=
function(){this.settings.requireSLDS=!0;if(this.settings.targetElement===document.body){var a=document.createElement("div");a.id="esw-snapin-target";document.body.appendChild(a);this.settings.targetElement=a}this.settings.targetElement.classList.add("slds-scope");a=document.createElement("link");a.href=(this.settings.gslbBaseURL?this.settings.gslbBaseURL:this.settings.baseCoreURL)+"/embeddedservice/"+this.settings.releaseVersion+"/esw-slds"+(this.settings.devMode?"":".min")+".css";a.type="text/css";
a.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(a)};d.prototype.validateHeaderValue=function(a){return/^[0-9a-zA-Z!#$%&'*+-.^_`|~" ]*$/g.test(a)};d.prototype.isLanguageRtl=function(a){if(a&&""!==a.trim())switch(a.substring(0,2)){case "ar":case "fa":case "he":case "iw":case "ji":case "ur":case "yi":return!0;default:return!1}};d.prototype.isDesktop=function(){return-1===navigator.userAgent.indexOf("Mobi")};window.embedded_svc=new d;Object.getOwnPropertyNames(l).forEach(function(a){var b=
l[a];"object"===b?(window.embedded_svc[a]={},Object.keys(b).forEach(function(c){window.embedded_svc[a][c]=b[c]})):window.embedded_svc[a]=b})})(window.embedded_svc||{});

	var initESW = function(gslbBaseURL) {
		embedded_svc.settings.displayHelpButton = false; //Or false
		embedded_svc.settings.language = ''; //For example, enter 'en' or 'en-US'

		//embedded_svc.settings.defaultMinimizedText = '...'; //(Defaults to Chat with an Expert)
		//embedded_svc.settings.disabledMinimizedText = '...'; //(Defaults to Agent Offline)

		//embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
		//embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

		// Settings for Chat
		//embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
			// Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
			// Returns a valid button ID.
		//};
		//embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
		//embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
		//embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)

		embedded_svc.settings.enabledFeatures = ['LiveAgent'];
		embedded_svc.settings.entryFeature = 'LiveAgent';

		embedded_svc.init(
			'https://pfizerpatientservices--helpdesk.my.salesforce.com',
			'https://helpdesk-testbot.cs27.force.com/liveAgentSetupFlow',
			gslbBaseURL,
			'00D22000000DPhW',
			'Xeljanz_Group',
			{
				baseLiveAgentContentURL: 'https://c.la1-c1cs-ia2.salesforceliveagent.com/content',
				deploymentId: '572220000008PQP',
				buttonId: '573220000008OR7',
				baseLiveAgentURL: 'https://d.la1-c1cs-ia2.salesforceliveagent.com/chat',
				eswLiveAgentDevName: 'Xeljanz_Group',
				isOfflineSupportEnabled: false
			}
		);
	};

	if (!window.embedded_svc) {
		var s = document.createElement('script');
		s.setAttribute('src', 'https://pfizerpatientservices--helpdesk.my.salesforce.com/embeddedservice/5.0/esw.min.js');
		s.onload = function() {
			initESW(null);
		};
		document.body.appendChild(s);
	} else {
		initESW('https://service.force.com');
	}    
    
    
    
function initialBotLoad(e) {
    if (e.srcElement.innerText == "Go Back" || e.srcElement.innerText == "Confirm End Chat") {
        getMenuListIndex();
    }
}

function getMenuListIndex() {
    let len = document.getElementsByClassName("rich-menu-items").length;
    for (let i = 0; i < len; i++) {
        if (document.getElementsByClassName("rich-menu-items")[i].children[0].innerText.trim() == "$$MainMenu$$") {
            formatMainMenu(i);
        }
    }
}

function formatMainMenu(classIndex) {
    if (document.getElementsByClassName("rich-menu-items")){
    document.getElementsByClassName("rich-menu-items")[classIndex].classList.add("main-menu-list");
    }
}

function messageListener(e) {
    if (e.data && typeof e.data === "object"){
    if ("method" in e.data && e.data.method == "liveagent.restored") {
        setTimeout(function(){
        var t = window.location.pathname;
        pageName = "/" === t ? "home" : t.substring(t.lastIndexOf("/") + 1), jQuery("clwcp-lwcchatpack").find("a").each(function() {
            jQuery(this).attr("sc:linkname", pageName + " | chatbot response | " + jQuery(this).attr("href")), jQuery(this).attr("onclick", "call_analytics( '" + jQuery(this).attr("href") + "');")
            if ($(this).text().includes("MedWatch") && $(this).attr("href") != "#") {
            $(this).removeAttr("target");
            $(this).attr("href","#");
            $(this).on("mousedown", function(e) {
              var param = jQuery(this).attr('sc:linkname');
              s.pfLinkName(param, "internal");
              e.preventDefault();
              jQuery("#fda-modal").modal('show');
            });
          }
        }); 
        }, 500);
        appendCSS();
        let iconEle = document.getElementsByClassName("chatbotStickyIcon")[0];
       
        if(window.innerWidth > 768){
            iconEle.classList.add("minimized");
        }
        getMenuListIndex();
    }

    if ("method" in e.data && e.data.method == "session.updatePrimary") {
        if (document.getElementById("chatbot-new-header") == null) {
            let newElement = document.createElement("div");
             newElement.innerHTML = '<div id="chatbot-new-header">XELJANZ<sup>R</sup><p><span>(tofacitinib)</span><span> Virtual Assistant </span></p></div>';
             if(document.querySelectorAll("embeddedservice-chat-header")[0]){
             document.querySelectorAll("embeddedservice-chat-header")[0].appendChild(newElement);
             }
            appendCSS();
        }
    }
    if ("data" in e.data && "event" in e.data.data && e.data.data.event == "agentRichMessage") {
        if (e.data.data.params.items[0].text == "$$MainMenu$$") {
            let classIndex = document.getElementsByClassName("rich-menu-items").length - 1;
            formatMainMenu(classIndex);
        }
    }
    

    /* handle minimize icon change on close button click */
    if ("method" in e.data && e.data.method == "session.deletedSessionData") {
        if (e.data.data.indexOf("ESW_IS_MINIMIZED") != -1) {
            let el = document.getElementsByClassName("chatbotStickyIcon")[0];
            el.classList.remove("minimized");
            
        }
    }
    if ("method" in e.data && e.data.method == "liveagent.event") {
        setTimeout(function(){
        var t = window.location.pathname;
        pageName = "/" === t ? "home" : t.substring(t.lastIndexOf("/") + 1), jQuery("clwcp-lwcchatpack").find("a").each(function() {
            jQuery(this).attr("sc:linkname", pageName + " | chatbot response | " + jQuery(this).attr("href")), jQuery(this).attr("onclick", "call_analytics( '" + jQuery(this).attr("href") + "');")
            if ($(this).text().includes("MedWatch") && $(this).attr("href") != "#") {
            $(this).removeAttr("target");
            $(this).attr("href","#");
            $(this).on("mousedown", function(e) {
              var param = jQuery(this).attr('sc:linkname');
              s.pfLinkName(pageName + " | chatbot response | http://www.fda.gov/MedWatch", "internal");
              e.preventDefault();
              jQuery("#fda-modal").modal('show');
            });
          }
        }); 
        }, 500);
    }
}
}
function call_analytics(e) {
    var t = window.location.pathname;
    pageName = "/" === t ? "home" : t.substring(t.lastIndexOf("/") + 1), s.pfLinkName(pageName + " | chatbot response | " + e, "internal")
}
//Gloval variable Added by SF Team
let globVar;

function showEmbeddedDiv(el) {
    let resultEmbServ = embedded_svc.bootstrapEmbeddedService();
    let chatWindow = document.getElementsByClassName("dockableContainer")[0];
    if (el.className.indexOf("minimized") > -1) {
        el.classList.remove("minimized");
        if("classList" in chatWindow){
            chatWindow.classList.add("hideDockablecontainer");
        }
        
        
    } else { 
        el.classList.add("minimized");
        if (chatWindow != undefined) {
            chatWindow.classList.remove("hideDockablecontainer");
            
        }
    }
    globVar = true;
}

if (window.addEventListener) {
    addEventListener('message', messageListener, false);
}
else {
    attachEvent('onmessage', messageListener);
}

document.addEventListener("click", initialBotLoad, false);

/*All the below Code added by SF Team -Need review from Vasundhara*/
embedded_svc.addEventHandler("afterMaximize",function(data){
    displayPI();
    if(window.innerWidth < 768) {       
        appendCSS();
        checkBOT();
		setBOTHeight();
    }
    setBotDimension();
});

function appendCSS(){
    var cssFa = document.createElement('link');
    cssFa.href = '/css/chatbot/XeljanzEinsteinBot.min.css';
    cssFa.rel = 'stylesheet';
    cssFa.type = 'text/css';
    document.getElementsByTagName('head')[0].appendChild(cssFa);
}
let navDiv, navList, navItem, anchorItem;

// getting links for the navbar
async function fetchLinksJSON() {
     return {
        "Prescribing Information": "http://labeling.pfizer.com/ShowLabeling.aspx?id=959",
        "Medication Guide": "http://labeling.pfizer.com/ShowLabeling.aspx?id=959&section=MedGuide"
    };
}



//onload is because script runs before body has loaded
//cant append to null body

function displayPI(){
    if(!document.getElementById("cb-dynamic-nav-list")){
        navList = document.createElement('ul');
        navList.className = 'cb-nav-container';
        navList.id = 'cb-dynamic-nav-list';
        navDiv = document.createElement("div");
        navDiv.appendChild(navList);
        document.body.appendChild(navDiv);
        fetchLinksJSON().then(function(jsonData){

        for (elem in jsonData){
            anchorItem = document.createElement('a');
            anchorItem.innerHTML = elem;
            anchorItem.href = jsonData[elem];
            anchorItem.target = "_blank";    
            navItem = document.createElement('li');
            navItem.className = 'cb-nav-item';
            navItem.appendChild(anchorItem);
            navList.appendChild(navItem);
        }
        })
        .catch(error => console.error('Err>>',error))   
        let dockable = document.getElementsByClassName("dockableContainer")[0];
        dockable.prepend(navList);
   }
}

function checkBOT() {
    //NEED TO ADD CONDITION ONLY FOR MOBILE SCREEN
    if(globVar==undefined){ 
        let el = document.getElementsByClassName("chatbotStickyIcon")[0]; 
        el.classList.remove("minimized");
        let chatWindow = document.getElementsByClassName("dockableContainer")[0]; 
        if(chatWindow!= undefined){
            chatWindow.classList.add("hideDockablecontainer");
        }
    }            
} 

function setBOTHeight(){
	let iSIHeight = document.querySelector('.isi-bottom .isi-container').offsetHeight;
	let botHeight = (window.innerHeight - iSIHeight)+ 'px';
	let botElement = document.getElementsByClassName('dockableContainer')[0];
	if(botElement){
		botElement.style.height = botHeight;
	}
}
function setLaunchIconHeight(){
	let isiHeight = document.querySelector('.isi-bottom .isi-container').offsetHeight;
	let iconEle = document.getElementsByClassName('chatbotStickyIcon');
	if(iconEle){
		iconEle[0].style.bottom = isiHeight+10+ 'px';
	}
}

function setBotDimension(){
    let dockableContainerVar =  document.getElementsByClassName("dockableContainer")[0];

    if(getComputedStyle(document.querySelector(".right-section .isi-sidebar")).display == "none") {
        if(document.getElementById("cb-dynamic-nav-list")) {
            document.getElementById("cb-dynamic-nav-list").style.display = "flex";
        }
        if(dockableContainerVar) {
            dockableContainerVar.style.top = 0;
            dockableContainerVar.style.left = 0;
            dockableContainerVar.style.minWidth = window.innerWidth - 10 + "px";
            dockableContainerVar.style.height = window.innerHeight - parseInt(getComputedStyle(document.querySelector(".isi-bottom .isi-container")).height.split("px")[0]) + "px";
            }
        if(document.getElementsByClassName("chatbotStickyIcon")[0]) {
            document.getElementsByClassName("chatbotStickyIcon")[0].style.bottom = parseInt(getComputedStyle(document.querySelector(".isi-bottom .isi-container")).height.split("px")[0]) + 15 + "px";
        }
    } else {
        var isiElementStyle = getComputedStyle(document.querySelector(".right-section .isi-container"));
        if(dockableContainerVar) {
            dockableContainerVar.style.bottom = window.innerHeight*0.15 + 10 + "px";
            dockableContainerVar.style.height = window.innerHeight*0.8 - 80 + "px";
            dockableContainerVar.style.right = parseInt(isiElementStyle.right.split("px")[0]) + parseInt(isiElementStyle.width.split("px")[0]) + 45 + "px";
            dockableContainerVar.style.width = 320 + "px";
            dockableContainerVar.style.top = "auto";
            dockableContainerVar.style.left = "auto";
            dockableContainerVar.style.minWidth = 0 + "px";
        }
        if(document.getElementsByClassName("chatbotStickyIcon")[0]) {
            document.getElementsByClassName("chatbotStickyIcon")[0].style.right = parseInt(isiElementStyle.right.split("px")[0]) + parseInt(isiElementStyle.width.split("px")[0]) + 20 + "px";
            document.getElementsByClassName("chatbotStickyIcon")[0].style.bottom = "15px";
        }
        if(document.getElementById("cb-dynamic-nav-list")) {
            document.getElementById("cb-dynamic-nav-list").style.display = "none";
        }
        
    }
}

window.addEventListener('resize', function(event){
    clearTimeout(window.resizedFinished);
    window.resizedFinished = setTimeout(function(){   
        setBotDimension();
    }, 300);
});

embedded_svc.addEventHandler("onChatEndedByChasitor", function(data) {
    embedded_svc.liveAgentAPI.clearSession();
    });
    


</script>
</body>
</html>
